import{H as b}from"./_chunk.43d6d570.js";import{F as k}from"./_chunk.95ba0f4f.js";import{_ as q,f as h,r as a,o as t,c as l,a as i,n as p,w as c,g as w,h as m,b as n,e as d,i as L,F as P}from"./main.c6ab2dd8.js";import{M as x}from"./_chunk.322796ac.js";import{E as F}from"./_chunk.2d418ff2.js";import{L as v}from"./_chunk.4ec6e6ce.js";const E={name:"PasswordRestView",components:{Loader:v,ErrorList:F,MessageList:x,FormItemText:k,Heading:b},data(){return{isRequest:!0,isLoaded:!1,isFormValid:!1,errors:[],messages:[],form:{login:"",password:"",passwordRepeat:""}}},watch:{form:{handler(){this.isRequest?this.isFormValid=this.form.login!=="":this.isFormValid=this.form.password!==""&&this.form.passwordRepeat!==""},deep:!0}},methods:{checkPasswords(){return this.form.password!==this.form.passwordRepeat?(this.errors.push("Passwords must match"),!1):this.form.password.length<7?(this.errors.push("Password must consist of at least 7 characters"),!1):this.form.password.length<7?(this.errors.push("Password must contain at least 7 characters"),!1):/^(?=.*\d)(?=.*[!@#$%^&*])(?=.*[a-z])(?=.*[A-Z]).{7,}$/.test(this.form.password)?!0:(this.errors.push("Password must contain symbol, upper and lower case letters and a number"),!1)},async formSubmit(){this.errors=[],this.messages=[],this.isRequest?await h.resetPasswordRequest({login:this.form.login}).then(e=>{e.data.success?this.messages.push(e.data.data):this.errors.push(e.data.data)}):this.checkPasswords()&&await h.resetPassword({login:this.$route.query.login,token:this.$route.query.token,password:this.form.password,passwordRepeat:this.form.passwordRepeat}).then(e=>{e.data.success?this.messages.push(e.data.data):this.errors.push(e.data.data)})}},mounted(){this.$route.query.login&&this.$route.query.token&&(this.isRequest=!1),this.isLoaded=!0}},M={key:0,class:"form__fieldset"},N={key:1,class:"form__fieldset"},S={class:"form__links"},B={class:"form__actions"},C=["disabled"],H={key:0,class:"form__actions-note"},T=n("sup",null,"(*)",-1);function I(e,r,U,z,s,f){const _=a("Loader"),g=a("Heading"),R=a("ErrorList"),V=a("MessageList"),u=a("FormItemText"),y=a("RouterLink");return t(),l(P,null,[i(_,{class:p({active:!s.isLoaded})},null,8,["class"]),s.isLoaded?(t(),l("div",{key:0,class:p(["wrapper",{"wrapper--form-short":s.isRequest,"wrapper--form":!s.isRequest}])},[i(g,{level:1,class:p("form-holder__heading")},{default:c(()=>[d("Password Reset")]),_:1}),s.errors.length?(t(),w(R,{key:0,errors:s.errors},null,8,["errors"])):m("",!0),s.messages.length?(t(),w(V,{key:1,messages:s.messages,type:"success"},null,8,["messages"])):m("",!0),n("form",{class:"form",onSubmit:r[3]||(r[3]=L((...o)=>f.formSubmit&&f.formSubmit(...o),["prevent"]))},[s.isRequest?(t(),l("div",M,[i(u,{name:"login",label:"Please enter your login or email","input-type":"text","is-required":!0,"css-modifier":"full",modelValue:s.form.login,"onUpdate:modelValue":r[0]||(r[0]=o=>s.form.login=o)},null,8,["modelValue"])])):(t(),l("div",N,[i(u,{name:"password",label:"Password","input-type":"password","is-required":!0,modelValue:s.form.password,"onUpdate:modelValue":r[1]||(r[1]=o=>s.form.password=o)},null,8,["modelValue"]),i(u,{name:"password-repeat",label:"Password repeat","input-type":"password","is-required":!0,modelValue:s.form.passwordRepeat,"onUpdate:modelValue":r[2]||(r[2]=o=>s.form.passwordRepeat=o)},null,8,["modelValue"])])),n("div",S,[i(y,{to:{name:"sign-up"}},{default:c(()=>[d("Not registered?")]),_:1})]),n("div",B,[n("button",{type:"submit",class:"button button--lime",disabled:!s.isFormValid},"Submit",8,C),s.isFormValid?m("",!0):(t(),l("span",H,[d("Please fill in all required "),T,d(" fields")]))])],32)],2)):m("",!0)],64)}const K=q(E,[["render",I]]);export{K as default};
